---
import MainFlexible from "../components/MainFlexible.astro";
import Layout from "../layouts/Layout.astro";
import { getPageBySlug, getAllPageSlugs } from "../lib/api";

const pages = await getAllPageSlugs();

pages.map((page) => {
    return {
        params: { slug: page },
    };
});

const { slug } = Astro.params;

if (slug === undefined) {
    throw new Error("Slug is required");
}

const page = await getPageBySlug(slug);
---

<Layout title={slug}>
    <MainFlexible page={page} />
</Layout>
